# Thorne Camp Scene - Post Contract 1

**Feature ID:** 3.11
**Status:** ðŸ”´ Planned
**Priority:** âž¡ï¸ Medium
**Estimated Time:** 1.5 hours
**Dependencies:** Task 3.10 (Camp Scene System)
**Assigned To:** AI Assistant

---

## Purpose

### Why does this feature exist?
This is the first camp scene after the tutorial contract, serving as the player's proper introduction to Thorne Blackwood as a character. The GDD states companions should feel like more than "combat stats" - this scene establishes Thorne's cynical warrior personality and gives players their first meaningful dialogue choice that affects companion loyalty.

### What does it enable?
- Players learn who Thorne is beyond "the warrior companion"
- Establishes Thorne's worldview: cynical, pragmatic, values strength and directness
- First camp conversation teaches the camp scene system through experience
- Player choices begin shaping their relationship with Thorne
- Sets up character dynamics for later camp scenes and story beats

### Success Criteria
- Scene triggers automatically after Contract 1 (Merchant's Escort) completion
- Thorne's personality (cynical veteran mercenary) comes through clearly
- Three distinct choices with different personality implications
- Loyalty changes apply correctly based on choice
- LoyaltyPopup displays the change
- Scene ends and returns player to hub smoothly

---

## How It Works

### Overview
After completing the first contract (Merchant's Escort tutorial), the player is taken to a camp scene where Thorne approaches them by the fire. He shares his views on mercenary work - specifically his cynicism about idealism and his belief that gold and survival are all that matter in this profession.

The player responds with one of three choices that reveal their captain's personality:
1. **Agree** - Pragmatic acceptance of Thorne's worldview (neutral)
2. **Disagree** - Idealistic pushback (Thorne slightly disapproves)
3. **Ask why** - Curiosity about his past (Thorne appreciates being heard)

This scene teaches players that companion conversations have consequences while establishing the first major NPC relationship.

### Narrative Context

**Setting:** Night, campfire after first successful contract
**Mood:** Contemplative, slightly tense
**Thorne's State:** Testing the new captain, gauging their character

**Character Background (revealed through dialogue):**
- Thorne has been a mercenary for over a decade
- He's seen idealistic captains get their companies killed
- He respects pragmatism over heroics
- He's curious whether this new captain is different

### User Flow
```
1. Contract 1 (Merchant's Escort) completes
2. Screen transitions to camp scene
3. Thorne's portrait appears, dialogue begins
4. Thorne shares his cynical philosophy (2-3 speaker nodes)
5. Player presented with 3 choices
6. Based on choice:
   - Agree: Thorne nods, neutral reaction
   - Disagree: Thorne frowns, warns about idealism
   - Ask why: Thorne opens up slightly, appreciates the interest
7. LoyaltyPopup shows change (if any)
8. Thorne closes with a final line
9. Scene ends, return to hub
```

### Dialogue Flow

```
[Thorne approaches by firelight]

THORNE: "Captain. Mind if I join you?"

[Beat - Thorne sits]

THORNE: "I've been with a dozen companies over the years.
         Most of them are dead now. You know why?"

[Player listens]

THORNE: "Idealism. Captains who thought they could be heroes.
         Who took contracts for 'the right reasons' instead of
         the right coin. This work isn't about glory - it's
         about survival. Gold keeps us fed, steel keeps us alive."

THORNE: "So I have to ask, Captain... what are you in this for?"

[CHOICE POINT]
â”œâ”€â–º "Gold and survival. Same as you." (Agree - 0 loyalty)
â”œâ”€â–º "There's more to life than coin." (Disagree - -5 loyalty)
â””â”€â–º "What happened to those other companies?" (Ask why - +5 loyalty)

[BRANCH: Agree]
THORNE: "*nods* Good. A practical captain. That's rare.
         We might just survive this after all."

[BRANCH: Disagree]
THORNE: "*sighs* I've heard that before. From captains
         who are rotting in unmarked graves now.
         I hope you prove me wrong, but I won't hold my breath."

[BRANCH: Ask why]
THORNE: "*pauses* ...You actually want to know?
         Most just want yes-men, not stories.

         The last company I served with - the Red Shields -
         took a contract defending a village that couldn't pay.
         'It's the right thing to do,' the captain said.

         We won. And then we starved because we had no coin
         for the winter. Half of us died before spring.

         I learned something that year, Captain. Good intentions
         don't fill bellies. But you asking... that's something.
         Most captains don't care what their soldiers think."

[CLOSING - All paths converge]
THORNE: "Anyway. Get some rest. Tomorrow we see what other
         work Ironmark has for sellswords like us."

[END - Return to Hub]
```

### Rules & Constraints

**Trigger Conditions:**
- Contract 1 (Merchant's Escort) must be completed
- This is a one-time scene (tracked in GameState)
- If Thorne has departed (loyalty 0), skip this scene

**Dialogue Requirements:**
- Minimum 4 speaker nodes before choice point
- Exactly 3 choices available
- Each choice leads to unique response
- All branches converge to same closing line
- Total dialogue ~8-10 speaker nodes

**Loyalty Changes:**
- Agree: 0 (neutral, no change)
- Disagree: -5 (Thorne dislikes idealism)
- Ask why: +5 (Thorne appreciates being heard)

---

## User Interaction

### Controls
Uses standard camp scene controls from Task 3.10:
| Input | Action |
|-------|--------|
| Left Click | Advance dialogue / Select choice |
| Space | Advance dialogue |
| Enter | Advance dialogue / Confirm choice |
| 1-3 Keys | Quick-select choice by number |

### Visual Feedback
- Thorne's portrait on left side
- Speaker name "THORNE" in his character color (#5dade2 - blue)
- Dialogue text with typewriter effect
- Choice buttons appear below dialogue box
- Loyalty indicator on choices that affect loyalty
- LoyaltyPopup slides in after choice

### Emotional Beats
1. **Opening:** Casual, companionable (fire, night, post-victory)
2. **Middle:** Increasingly serious as Thorne shares philosophy
3. **Choice moment:** Tension - player defining their character
4. **Resolution:** Varies by choice (acceptance/warning/connection)
5. **Closing:** Return to professional rapport

---

## Visual Design

### Scene Layout
Uses standard CampDialogue scene from Task 3.10:
```
+------------------------------------------------------------------+
|                      [Night Camp Background]                      |
|                                                                   |
|  +----------+                                                     |
|  | THORNE   |                                                     |
|  | Portrait |                                                     |
|  | (Left)   |                                                     |
|  +----------+                                                     |
|                                                                   |
+------------------------------------------------------------------+
|  THORNE                                                           |
|  ---------------------------------------------------------------- |
|  "This work isn't about glory - it's about survival.             |
|   Gold keeps us fed, steel keeps us alive."                      |
|                                                     [â–¼ Continue]  |
+------------------------------------------------------------------+
```

### Choice Display
```
+------------------------------------------------------------------+
|  [1] "Gold and survival. Same as you."                           |
|  [2] "There's more to life than coin."              (-Thorne)    |
|  [3] "What happened to those other companies?"      (+Thorne)    |
+------------------------------------------------------------------+
```

### Portrait States
- `thorne_neutral` - Default, listening/speaking normally
- `thorne_approving` - When player asks about his past
- `thorne_disapproval` - When player disagrees with his philosophy
- `thorne_thoughtful` - When sharing memories of Red Shields

---

## Technical Implementation

### File Structure
```
resources/dialogue/thorne_camp_1.json    # Dialogue tree
```

### JSON Dialogue Format
Following the schema established in Task 3.10:

```json
{
  "id": "thorne_camp_1",
  "title": "Thorne - After the First Contract",
  "trigger_contract": "merchants_escort",
  "one_time": true,
  "nodes": {
    "start_1": {
      "type": "Start",
      "connections": [{"to": "speaker_1", "port": 0}]
    },
    "speaker_1": {
      "type": "Speaker",
      "speaker": "thorne",
      "portrait": "thorne_neutral",
      "text": "Captain. Mind if I join you?",
      "connections": [{"to": "speaker_2", "port": 0}]
    },
    // ... additional nodes
    "choice_agree": {
      "type": "Choice",
      "text": "Gold and survival. Same as you.",
      "loyalty_changes": {},
      "connections": [{"to": "speaker_agree", "port": 0}]
    },
    "choice_disagree": {
      "type": "Choice",
      "text": "There's more to life than coin.",
      "loyalty_changes": {"thorne": -5},
      "connections": [{"to": "speaker_disagree", "port": 0}]
    },
    "choice_ask": {
      "type": "Choice",
      "text": "What happened to those other companies?",
      "loyalty_changes": {"thorne": 5},
      "connections": [{"to": "speaker_ask", "port": 0}]
    },
    // ... response nodes and closing
  }
}
```

### Integration Points

| System | Integration |
|--------|-------------|
| **CampDialogue** | Loads and displays this dialogue JSON |
| **LoyaltyManager** | Applies loyalty changes from choices |
| **LoyaltyPopup** | Displays "+5 Thorne" or "-5 Thorne" |
| **GameState** | Tracks that this scene has been viewed |
| **Contract System** | Triggers scene after contract completion |

### Contract Integration
In the contract completion flow, check for pending camp scenes:

```gdscript
# In contract completion handler
func _on_contract_completed(contract_id: String) -> void:
    # Check for triggered camp scenes
    if contract_id == "merchants_escort":
        if not GameState.has_viewed_scene("thorne_camp_1"):
            _load_camp_scene("thorne_camp_1")
            return

    # No camp scene, return to hub
    _return_to_hub()
```

### Signals
Uses existing signals from CampDialogue (Task 3.10):
- `scene_started(scene_id: String)`
- `scene_ended(scene_id: String)`
- `choice_selected(choice_index: int, choice_text: String)`

---

## Acceptance Criteria

- [ ] Scene triggers automatically after Merchant's Escort completion
- [ ] Thorne's cynical mercenary personality established through dialogue
- [ ] Three choices available: Agree, Disagree, Ask why
- [ ] "Agree" choice results in 0 loyalty change
- [ ] "Disagree" choice results in -5 Thorne loyalty
- [ ] "Ask why" choice results in +5 Thorne loyalty
- [ ] LoyaltyPopup displays after choice (if change occurred)
- [ ] Scene marked as viewed in GameState (doesn't repeat)
- [ ] Scene transitions smoothly back to hub after ending
- [ ] Dialogue text conveys Thorne's character effectively

---

## Testing Checklist

### Functional Tests
- [ ] Scene loads without errors
- [ ] All speaker nodes display correctly
- [ ] All three choices appear at choice point
- [ ] Each choice leads to correct response branch
- [ ] Loyalty changes apply correctly per choice
- [ ] LoyaltyPopup appears for non-zero changes
- [ ] Scene ends and returns to hub

### Narrative Tests
- [ ] Thorne's dialogue feels authentic to his character
- [ ] Each choice response makes sense
- [ ] Emotional progression feels natural
- [ ] "Ask why" branch provides meaningful backstory
- [ ] Closing line works for all branches

### Integration Tests
- [ ] Scene triggers after contract completion
- [ ] Scene doesn't trigger if already viewed
- [ ] Scene doesn't trigger if Thorne has departed
- [ ] Loyalty value persists after scene
- [ ] Hub displays updated loyalty on return

### Edge Case Tests
- [ ] Rapid clicking doesn't break dialogue
- [ ] All input methods work (click, space, enter, number keys)
- [ ] Scene handles typewriter skip correctly

---

## Implementation Notes

### Approach
1. Create JSON dialogue file with full dialogue tree
2. Update contract completion flow to check for camp scene triggers
3. Add GameState tracking for viewed scenes
4. Test all three choice branches
5. Verify loyalty changes and popup display

### Character Voice Guidelines
Thorne speaks like a grizzled veteran:
- Short, direct sentences
- Military vocabulary ("company", "contract", "steel")
- Cynical observations
- Occasional dark humor
- Doesn't waste words on pleasantries

**Example phrases:**
- "I've seen plenty of captains..." (experience)
- "Gold keeps us fed, steel keeps us alive." (pragmatism)
- "I won't hold my breath." (cynicism)
- "That's something." (guarded approval)

### Emotional Arc
1. **Professional** - Thorne requesting permission to speak
2. **Testing** - Sharing philosophy, gauging reaction
3. **Vulnerable** (Ask path) - Opening up about past
4. **Resolved** - Accepting captain's response
5. **Return to baseline** - Professional closing

### Gotchas
- Ensure "Ask why" branch is longer (backstory reveal)
- Loyalty changes should feel earned, not arbitrary
- Closing line must work regardless of branch taken
- Don't make Thorne too sympathetic too fast

---

## Files

**New Files:**
- `resources/dialogue/thorne_camp_1.json` - Dialogue tree JSON

**Modified Files:**
- Contract completion handlers (add camp scene trigger check)
- GameState (add scene viewed tracking if not present)

**Existing Files Used:**
- `scenes/camp/CampDialogue.tscn` - Dialogue display scene
- `scripts/camp/camp_dialogue.gd` - Dialogue controller
- `scripts/systems/dialogue_manager.gd` - JSON parser
- `scripts/autoload/loyalty_manager.gd` - Loyalty changes
- `scenes/UI/LoyaltyPopup.tscn` - Change display

---

## Hardcoded Values

| Value | Amount | Description |
|-------|--------|-------------|
| Agree loyalty change | 0 | Neutral response |
| Disagree loyalty change | -5 | Thorne dislikes idealism |
| Ask why loyalty change | +5 | Thorne appreciates interest |
| Trigger contract | "merchants_escort" | First contract ID |
| Scene ID | "thorne_camp_1" | Unique identifier |

---

## Future Considerations

This scene sets up potential future content:
- Reference to "Red Shields" company can be callback in later scenes
- Thorne's reaction here affects how he responds in Border Dispute
- If player chose "Ask why", Thorne might share more in future scenes
- Creates foundation for Thorne's personal quest (if implemented)
